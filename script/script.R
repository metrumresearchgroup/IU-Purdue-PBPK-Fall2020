# load libraries
library(tidyverse)
library(mrgsolve)
library(FME)
library(sensitivity)
library(nloptr)

# Chunks 1-2 are relevant to simplePBPK
# Chunks 3- are relevant to voriPBPK model

################################################################################
###################  Chunk 1: Compile simplePBPK model  ########################
################################################################################

mod <- mread("simplePBPK", "models")

################################################################################
################################################################################

################################################################################
###################  Chunk 2: Run a simple simulation ##########################
################################################################################
## Simulate a 100 mg dose given as an IV bolus
mod %>%
  ev(amt=100, cmt="VEN") %>%
  mrgsim(end=100) %>%
  plot()

################################################################################
################################################################################

################################################################################
#####################  Chunk 3: Compile voriPBPK model #########################
################################################################################

modA <- mread("../model/voriPBPK_solution")

################################################################################
################################################################################

################################################################################
################  Chunk 4: Calculate partition coefficients ####################
################################################################################

modA <- mread("../model/voriPBPK_solution")

################################################################################
################################################################################

